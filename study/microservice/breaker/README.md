### 服务熔断
> 微服务架构中，服务的依赖和调用关系错综复杂。如服务A调用服务B，服务B调用服务C，如果此时服务C有问题，导致服务B拿不到响应结果，
> 而后不断重新请求服务C，导致服务C出现大量请求积压，进而资源耗尽，影响到整个服务链路，形成雪崩效应。

为了解决雪崩效应，需要建立有效的服务容错机制，可以做服务的集群和重试机制，提供服务的可用性，
而当服务出错时，可以设置不同的失败策略，如：
- FailFast 快速失败
- Failover 失败转移
- Failback 失败通知
- Failsafe 失败安全

除了集群容错外，也可以采用服务熔断和限流

#### 熔断器
熔断机制类似于我们日常生活的电路保护器，但电路超负荷运行时，电路保险丝会自动断开，从而保护电路中的电器不受损害。
服务治理中的熔断机制，指的是发起服务调用时，如果被调用方返回的错误率超过一定的阈值，那么后续不会请求，而是在调用方直接返回错误。

服务调用方维护一个状态机，包含三种状态：
- 关闭（Closed）
- 打开（Open）
- 半开（Half-Open）

#### 熔断机制
```

                                 switch to open
        +-----------------------------------------------------------------------+
        |                                                                       |
        |                                                                       v
+----------------+                   +----------------+      Probe      +----------------+
|                |                   |                |<----------------|                |
|                |   Probe succeed   |                |                 |                |
|     Closed     |<------------------|    HalfOpen    |                 |      Open      |
|                |                   |                |   Probe failed  |                |
|                |                   |                |---------------->|                |
+----------------+                   +----------------+                 +----------------+

```